<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RAZZER OS - Dashboard</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            overflow: hidden;
            background: #000;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Helvetica Neue', Arial, sans-serif;
            color: #fff;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #000000 0%, #0a0a0a 100%);
        }

        /* Status Bar */
        #statusBar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 1001;
            font-size: 13px;
            font-weight: 400;
        }

        .status-time {
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
        }

        .status-items {
            display: flex;
            gap: 16px;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Start Menu - Apple Clean Style */
        #startMenu {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-radius: 16px;
            padding: 8px;
            display: flex;
            gap: 12px;
            z-index: 1000;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.4),
                0 1px 0 rgba(255, 255, 255, 0.1) inset;
            min-width: 240px;
            justify-content: center;
        }

        .app-icon {
            width: 70px;
            height: 60px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
        }

        .app-icon:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .app-icon.active {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .app-icon::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.2) 50%, 
                transparent 100%);
        }

        .app-label {
            font-size: 9px;
            font-weight: 500;
            letter-spacing: 0.3px;
            color: rgba(255, 255, 255, 0.9);
            margin-top: 4px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .app-symbol {
            font-size: 14px;
            font-weight: 300;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 2px;
            text-align: center;
            line-height: 1.2;
        }

        /* App Windows */
        .app-window {
            position: absolute;
            width: 600px;
            height: 500px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 1px 0 rgba(255, 255, 255, 0.1) inset;
            z-index: 100;
            display: none;
            overflow: hidden;
            cursor: move;
        }

        .app-window.active {
            display: block;
            animation: windowAppear 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .app-window.dragging {
            cursor: grabbing;
            z-index: 1000;
        }

        @keyframes windowAppear {
            from {
                opacity: 0;
                transform: scale(0.95) translateY(10px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .window-header {
            height: 50px;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.03);
            cursor: move;
        }

        .window-title {
            font-size: 17px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
            letter-spacing: -0.2px;
            user-select: none;
        }

        .window-controls {
            display: flex;
            gap: 8px;
        }

        .window-btn {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 16px;
            line-height: 1;
        }

        .window-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .window-btn.close:hover {
            background: rgba(255, 59, 48, 0.2);
            color: #ff3b30;
            border-color: rgba(255, 59, 48, 0.3);
        }

        .window-content {
            height: calc(100% - 50px);
            padding: 20px;
            cursor: default;
        }

        /* Graph Styles */
        .graph-container {
            width: 100%;
            height: 100%;
            position: relative;
        }

        canvas {
            display: block;
        }

        .graph-info {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 2;
        }

        .graph-title {
            font-size: 24px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 4px;
            letter-spacing: -0.5px;
        }

        .graph-subtitle {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 400;
        }

        .graph-stats {
            position: absolute;
            top: 20px;
            right: 20px;
            text-align: right;
            z-index: 2;
        }

        .graph-value {
            font-size: 28px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 2px;
        }

        .graph-change {
            font-size: 13px;
            font-weight: 500;
        }

        .change-positive {
            color: #30d158;
        }

        .change-negative {
            color: #ff453a;
        }

        .axis-label {
            position: absolute;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
            font-weight: 400;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .y-axis-label {
            left: 10px;
            top: 50%;
            transform: translateY(-50%) rotate(-90deg);
            transform-origin: left center;
        }

        .x-axis-label {
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
        }

        /* Background Pattern */
        .bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 149, 0, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(52, 199, 89, 0.03) 0%, transparent 50%);
            z-index: 0;
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>

    <!-- Status Bar -->
    <div id="statusBar">
        <div class="status-time" id="currentTime">--:--</div>
        <div class="status-items">
            <span>RAZZER</span>
            <span>OS 1.0</span>
            <span id="networkStatus">● ONLINE</span>
        </div>
    </div>

    <!-- Start Menu -->
    <div id="startMenu">
        <div class="app-icon" data-app="maspot">
            <div class="app-symbol">MA/SPOT</div>
            <div class="app-label">Market Analysis</div>
        </div>
        <div class="app-icon" data-app="fund">
            <div class="app-symbol">FUND</div>
            <div class="app-label">Fund Dashboard</div>
        </div>
    </div>

    <!-- MA/SPOT App Window -->
    <div id="maspotWindow" class="app-window">
        <div class="window-header">
            <div class="window-title">MA/SPOT - Market Analysis</div>
            <div class="window-controls">
                <div class="window-btn minimize">–</div>
                <div class="window-btn maximize">□</div>
                <div class="window-btn close">×</div>
            </div>
        </div>
        <div class="window-content">
            <div class="graph-container">
                <div class="graph-info">
                    <div class="graph-title">MA/SPOT Analysis</div>
                    <div class="graph-subtitle">Real-time price tracking</div>
                </div>
                <div class="graph-stats">
                    <div class="graph-value" id="maspotValue">$24,850.34</div>
                    <div class="graph-change change-positive" id="maspotChange">+2.34%</div>
                </div>
                <div class="axis-label y-axis-label">PRICE (USD)</div>
                <div class="axis-label x-axis-label">BLOCK</div>
                <canvas id="maspotCanvas"></canvas>
            </div>
        </div>
    </div>

    <!-- FUND App Window -->
    <div id="fundWindow" class="app-window">
        <div class="window-header">
            <div class="window-title">FUND - ZSD Dashboard</div>
            <div class="window-controls">
                <div class="window-btn minimize">–</div>
                <div class="window-btn maximize">□</div>
                <div class="window-btn close">×</div>
            </div>
        </div>
        <div class="window-content">
            <div class="graph-container">
                <div class="graph-info">
                    <div class="graph-title">FUND Performance</div>
                    <div class="graph-subtitle">ZSD token metrics</div>
                </div>
                <div class="graph-stats">
                    <div class="graph-value" id="fundValue">$1,024.85</div>
                    <div class="graph-change change-positive" id="fundChange">+0.85%</div>
                </div>
                <div class="axis-label y-axis-label">$ZSD</div>
                <div class="axis-label x-axis-label">BLOCK</div>
                <canvas id="fundCanvas"></canvas>
            </div>
        </div>
    </div>

    <script>
        // ============================================================================
        // RAZZER OS - APP MANAGER
        // ============================================================================
        class RAZZEROperatingSystem {
            constructor() {
                console.log("Initializing RAZZER OS...");
                
                // App state
                this.activeApps = new Set();
                this.apps = {
                    maspot: new MASpotApp(),
                    fund: new FundApp()
                };
                
                this.zIndexCounter = 100;
                this.windowPositions = {};
                
                // Initialize
                this.init();
            }
            
            init() {
                // Setup event listeners
                this.setupEventListeners();
                
                // Update time
                this.updateTime();
                setInterval(() => this.updateTime(), 1000);
                
                // Initialize apps
                Object.values(this.apps).forEach(app => app.init());
                
                console.log("RAZZER OS initialized successfully");
            }
            
            setupEventListeners() {
                // App icon clicks
                document.querySelectorAll('.app-icon').forEach(icon => {
                    icon.addEventListener('click', (e) => {
                        const appName = e.currentTarget.getAttribute('data-app');
                        this.openApp(appName);
                    });
                });
                
                // Window controls
                document.querySelectorAll('.window-btn.close').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const window = e.target.closest('.app-window');
                        const appName = window.id.replace('Window', '');
                        this.closeApp(appName);
                    });
                });
                
                // Minimize buttons
                document.querySelectorAll('.window-btn.minimize').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const window = e.target.closest('.app-window');
                        window.style.opacity = '0.5';
                        window.style.transform = 'scale(0.95)';
                        setTimeout(() => {
                            window.style.opacity = '1';
                            window.style.transform = 'scale(1)';
                        }, 150);
                    });
                });
                
                // Maximize buttons
                document.querySelectorAll('.window-btn.maximize').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const window = e.target.closest('.app-window');
                        window.classList.toggle('maximized');
                        if (window.classList.contains('maximized')) {
                            window.style.top = '40px';
                            window.style.left = '0';
                            window.style.right = '0';
                            window.style.bottom = '0';
                            window.style.width = '100%';
                            window.style.height = 'calc(100vh - 40px)';
                        } else {
                            window.style.top = window.dataset.originalTop || '100px';
                            window.style.left = window.dataset.originalLeft || '100px';
                            window.style.right = 'auto';
                            window.style.bottom = 'auto';
                            window.style.width = '600px';
                            window.style.height = '500px';
                        }
                        // Resize canvas
                        const appName = window.id.replace('Window', '');
                        setTimeout(() => {
                            this.apps[appName].resizeCanvas();
                        }, 100);
                    });
                });
                
                // Setup window dragging
                this.setupWindowDragging();
                
                // Close app with ESC key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        // Close the topmost window
                        const topWindow = this.getTopmostWindow();
                        if (topWindow) {
                            const appName = topWindow.id.replace('Window', '');
                            this.closeApp(appName);
                        }
                    }
                });
            }
            
            setupWindowDragging() {
                document.querySelectorAll('.app-window').forEach(window => {
                    const header = window.querySelector('.window-header');
                    let isDragging = false;
                    let startX, startY, initialX, initialY;
                    
                    const startDrag = (e) => {
                        if (e.target.classList.contains('window-btn')) return;
                        
                        isDragging = true;
                        window.classList.add('dragging');
                        
                        startX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                        startY = e.type.includes('mouse') ? e.clientY : e.touches[0].clientY;
                        
                        const rect = window.getBoundingClientRect();
                        initialX = rect.left;
                        initialY = rect.top;
                        
                        // Store original position if not maximized
                        if (!window.classList.contains('maximized')) {
                            window.dataset.originalTop = initialY + 'px';
                            window.dataset.originalLeft = initialX + 'px';
                        }
                        
                        // Bring to front
                        this.bringToFront(window);
                    };
                    
                    const drag = (e) => {
                        if (!isDragging) return;
                        
                        e.preventDefault();
                        
                        const currentX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                        const currentY = e.type.includes('mouse') ? e.clientY : e.touches[0].clientY;
                        
                        const deltaX = currentX - startX;
                        const deltaY = currentY - startY;
                        
                        window.style.left = (initialX + deltaX) + 'px';
                        window.style.top = (initialY + deltaY) + 'px';
                    };
                    
                    const endDrag = () => {
                        isDragging = false;
                        window.classList.remove('dragging');
                    };
                    
                    // Mouse events
                    header.addEventListener('mousedown', startDrag);
                    document.addEventListener('mousemove', drag);
                    document.addEventListener('mouseup', endDrag);
                    
                    // Touch events
                    header.addEventListener('touchstart', startDrag);
                    document.addEventListener('touchmove', drag);
                    document.addEventListener('touchend', endDrag);
                });
            }
            
            bringToFront(window) {
                this.zIndexCounter++;
                window.style.zIndex = this.zIndexCounter;
            }
            
            getTopmostWindow() {
                const windows = document.querySelectorAll('.app-window.active');
                let topWindow = null;
                let highestZ = 0;
                
                windows.forEach(window => {
                    const z = parseInt(window.style.zIndex) || 0;
                    if (z > highestZ) {
                        highestZ = z;
                        topWindow = window;
                    }
                });
                
                return topWindow;
            }
            
            openApp(appName) {
                const window = document.getElementById(`${appName}Window`);
                const icon = document.querySelector(`[data-app="${appName}"]`);
                
                if (!this.activeApps.has(appName)) {
                    // Set initial position for new windows
                    if (!this.windowPositions[appName]) {
                        const openApps = Array.from(this.activeApps);
                        const offset = openApps.length * 30;
                        window.style.left = (100 + offset) + 'px';
                        window.style.top = (100 + offset) + 'px';
                        this.windowPositions[appName] = true;
                    }
                    
                    window.classList.add('active');
                    icon.classList.add('active');
                    this.activeApps.add(appName);
                    
                    // Start app animation
                    this.apps[appName].start();
                    
                    // Bring to front
                    this.bringToFront(window);
                    
                    // Resize canvas after window is visible
                    setTimeout(() => {
                        this.apps[appName].resizeCanvas();
                    }, 100);
                    
                    console.log(`Opened app: ${appName}`);
                } else {
                    // App already open, just bring to front
                    this.bringToFront(window);
                }
            }
            
            closeApp(appName) {
                const window = document.getElementById(`${appName}Window`);
                const icon = document.querySelector(`[data-app="${appName}"]`);
                
                window.classList.remove('active');
                icon.classList.remove('active');
                this.activeApps.delete(appName);
                
                // Stop app animation
                this.apps[appName].stop();
                
                console.log(`Closed app: ${appName}`);
            }
            
            updateTime() {
                const now = new Date();
                const timeStr = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                document.getElementById('currentTime').textContent = timeStr;
            }
        }

        // ============================================================================
        // BASE GRAPH APP
        // ============================================================================
        class GraphApp {
            constructor(canvasId, config) {
                this.canvas = document.getElementById(canvasId);
                this.ctx = this.canvas.getContext('2d');
                this.config = config;
                
                // Data
                this.data = [];
                this.currentBlock = 1000000;
                this.lastUpdate = 0;
                this.animationId = null;
                
                // Initialize canvas
                this.resizeCanvas();
                window.addEventListener('resize', () => this.resizeCanvas());
            }
            
            init() {
                // Generate initial data
                this.generateData(200);
            }
            
            resizeCanvas() {
                const container = this.canvas.parentElement;
                this.canvas.width = container.clientWidth;
                this.canvas.height = container.clientHeight;
                this.render();
            }
            
            generateData(count) {
                this.data = [];
                let price = this.config.initialPrice;
                
                for (let i = 0; i < count; i++) {
                    const block = this.currentBlock - (count - i) + 1;
                    
                    // Simulate price movement
                    const change = (Math.random() - 0.5) * this.config.volatility;
                    price = price * (1 + change);
                    price = Math.max(price, this.config.minPrice);
                    price = Math.min(price, this.config.maxPrice);
                    
                    this.data.push({
                        block: block,
                        value: price,
                        timestamp: Date.now() - (count - i) * 60000 // 1 min per block
                    });
                }
                
                this.currentBlock = this.data[this.data.length - 1].block;
            }
            
            updateData() {
                // Add new data point
                const lastPrice = this.data[this.data.length - 1].value;
                
                // Simulate price movement with trend
                const trend = Math.sin(Date.now() / 1000000) * 0.1; // Long term trend
                const noise = (Math.random() - 0.5) * this.config.volatility * 2;
                const news = Math.random() < 0.05 ? (Math.random() - 0.5) * this.config.volatility * 5 : 0;
                
                let newPrice = lastPrice * (1 + trend + noise + news);
                newPrice = Math.max(newPrice, this.config.minPrice);
                newPrice = Math.min(newPrice, this.config.maxPrice);
                
                this.currentBlock++;
                this.data.push({
                    block: this.currentBlock,
                    value: newPrice,
                    timestamp: Date.now()
                });
                
                // Keep data length manageable
                if (this.data.length > 300) {
                    this.data.shift();
                }
                
                // Update display values
                this.updateDisplay();
            }
            
            updateDisplay() {
                const lastValue = this.data[this.data.length - 1].value;
                const prevValue = this.data[Math.max(0, this.data.length - 2)].value;
                const change = ((lastValue - prevValue) / prevValue) * 100;
                
                // Update DOM
                const valueElement = document.getElementById(`${this.config.id}Value`);
                const changeElement = document.getElementById(`${this.config.id}Change`);
                
                if (valueElement) {
                    valueElement.textContent = this.config.formatValue(lastValue);
                }
                
                if (changeElement) {
                    changeElement.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(2)}%`;
                    changeElement.className = `graph-change ${change >= 0 ? 'change-positive' : 'change-negative'}`;
                }
            }
            
            render() {
                const ctx = this.ctx;
                const width = this.canvas.width;
                const height = this.canvas.height;
                
                // Clear canvas
                ctx.clearRect(0, 0, width, height);
                
                if (this.data.length < 2) return;
                
                // Calculate data bounds
                const values = this.data.map(d => d.value);
                const minValue = Math.min(...values);
                const maxValue = Math.max(...values);
                const valueRange = maxValue - minValue;
                
                const blocks = this.data.map(d => d.block);
                const minBlock = Math.min(...blocks);
                const maxBlock = Math.max(...blocks);
                const blockRange = maxBlock - minBlock;
                
                // Set up margins
                const margin = { top: 40, right: 40, bottom: 40, left: 40 };
                const graphWidth = width - margin.left - margin.right;
                const graphHeight = height - margin.top - margin.bottom;
                
                // Draw grid
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
                ctx.lineWidth = 1;
                
                // Horizontal grid lines
                for (let i = 0; i <= 5; i++) {
                    const y = margin.top + (i * graphHeight / 5);
                    ctx.beginPath();
                    ctx.moveTo(margin.left, y);
                    ctx.lineTo(width - margin.right, y);
                    ctx.stroke();
                    
                    // Grid labels
                    const value = minValue + (5 - i) * (valueRange / 5);
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
                    ctx.font = '10px -apple-system, BlinkMacSystemFont, sans-serif';
                    ctx.textAlign = 'right';
                    ctx.fillText(this.config.formatGridValue(value), margin.left - 8, y + 3);
                }
                
                // Vertical grid lines
                const visiblePoints = Math.min(10, this.data.length);
                for (let i = 0; i <= visiblePoints; i++) {
                    const x = margin.left + (i * graphWidth / visiblePoints);
                    ctx.beginPath();
                    ctx.moveTo(x, margin.top);
                    ctx.lineTo(x, height - margin.bottom);
                    ctx.stroke();
                }
                
                // Draw graph line
                ctx.beginPath();
                for (let i = 0; i < this.data.length; i++) {
                    const point = this.data[i];
                    const x = margin.left + ((point.block - minBlock) / blockRange) * graphWidth;
                    const y = margin.top + ((maxValue - point.value) / valueRange) * graphHeight;
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                
                // Line gradient
                const gradient = ctx.createLinearGradient(0, margin.top, 0, height - margin.bottom);
                gradient.addColorStop(0, this.config.gradientTop);
                gradient.addColorStop(1, this.config.gradientBottom);
                
                ctx.strokeStyle = gradient;
                ctx.lineWidth = 2;
                ctx.lineJoin = 'round';
                ctx.lineCap = 'round';
                ctx.stroke();
                
                // Draw area under line
                ctx.lineTo(width - margin.right, height - margin.bottom);
                ctx.lineTo(margin.left, height - margin.bottom);
                ctx.closePath();
                
                const areaGradient = ctx.createLinearGradient(0, margin.top, 0, height - margin.bottom);
                areaGradient.addColorStop(0, this.config.areaTop);
                areaGradient.addColorStop(1, this.config.areaBottom);
                
                ctx.fillStyle = areaGradient;
                ctx.fill();
                
                // Draw current point
                if (this.data.length > 0) {
                    const lastPoint = this.data[this.data.length - 1];
                    const lastX = margin.left + ((lastPoint.block - minBlock) / blockRange) * graphWidth;
                    const lastY = margin.top + ((maxValue - lastPoint.value) / valueRange) * graphHeight;
                    
                    // Point glow
                    ctx.beginPath();
                    ctx.arc(lastX, lastY, 10, 0, Math.PI * 2);
                    ctx.fillStyle = this.config.glowColor;
                    ctx.globalAlpha = 0.3;
                    ctx.fill();
                    ctx.globalAlpha = 1;
                    
                    // Point
                    ctx.beginPath();
                    ctx.arc(lastX, lastY, 4, 0, Math.PI * 2);
                    ctx.fillStyle = '#ffffff';
                    ctx.fill();
                    ctx.strokeStyle = this.config.glowColor;
                    ctx.lineWidth = 2;
                    ctx.stroke();
                }
                
                // Draw block labels
                if (blockRange > 0) {
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
                    ctx.font = '10px -apple-system, BlinkMacSystemFont, sans-serif';
                    ctx.textAlign = 'center';
                    
                    const step = Math.max(1, Math.floor(this.data.length / 5));
                    for (let i = 0; i < this.data.length; i += step) {
                        if (i >= this.data.length) break;
                        
                        const point = this.data[i];
                        const x = margin.left + ((point.block - minBlock) / blockRange) * graphWidth;
                        const y = height - margin.bottom + 20;
                        
                        // Format block number with commas
                        const blockStr = point.block.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                        ctx.fillText(blockStr, x, y);
                    }
                }
            }
            
            start() {
                // Clear any existing animation
                if (this.animationId) {
                    cancelAnimationFrame(this.animationId);
                }
                
                // Start animation loop
                const animate = () => {
                    const now = Date.now();
                    if (now - this.lastUpdate > this.config.updateInterval) {
                        this.updateData();
                        this.lastUpdate = now;
                    }
                    
                    this.render();
                    this.animationId = requestAnimationFrame(animate);
                };
                
                animate();
            }
            
            stop() {
                if (this.animationId) {
                    cancelAnimationFrame(this.animationId);
                    this.animationId = null;
                }
            }
        }

        // ============================================================================
        // MA/SPOT APP
        // ============================================================================
        class MASpotApp extends GraphApp {
            constructor() {
                super('maspotCanvas', {
                    id: 'maspot',
                    initialPrice: 25000,
                    minPrice: 15000,
                    maxPrice: 35000,
                    volatility: 0.02,
                    updateInterval: 2000,
                    formatValue: (value) => `$${value.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`,
                    formatGridValue: (value) => `$${value.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`,
                    gradientTop: 'rgba(10, 132, 255, 1)',
                    gradientBottom: 'rgba(94, 92, 230, 1)',
                    areaTop: 'rgba(10, 132, 255, 0.2)',
                    areaBottom: 'rgba(94, 92, 230, 0.1)',
                    glowColor: 'rgba(10, 132, 255, 1)'
                });
            }
        }

        // ============================================================================
        // FUND APP
        // ============================================================================
        class FundApp extends GraphApp {
            constructor() {
                super('fundCanvas', {
                    id: 'fund',
                    initialPrice: 1000,
                    minPrice: 800,
                    maxPrice: 1200,
                    volatility: 0.01,
                    updateInterval: 2000,
                    formatValue: (value) => `$${value.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})} ZSD`,
                    formatGridValue: (value) => `$${value.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`,
                    gradientTop: 'rgba(52, 199, 89, 1)',
                    gradientBottom: 'rgba(48, 209, 88, 1)',
                    areaTop: 'rgba(52, 199, 89, 0.2)',
                    areaBottom: 'rgba(48, 209, 88, 0.1)',
                    glowColor: 'rgba(52, 199, 89, 1)'
                });
            }
        }

        // ============================================================================
        // INITIALIZE OS
        // ============================================================================
        window.addEventListener('load', () => {
            console.log("Loading RAZZER OS...");
            
            try {
                // Initialize the operating system
                const razerOS = new RAZZEROperatingSystem();
                window.razerOS = razerOS;
                
                // Update network status
                setInterval(() => {
                    const status = document.getElementById('networkStatus');
                    const isOnline = navigator.onLine;
                    status.textContent = isOnline ? '● ONLINE' : '● OFFLINE';
                    status.style.color = isOnline ? 'rgba(52, 199, 89, 0.8)' : 'rgba(255, 69, 58, 0.8)';
                }, 5000);
                
                console.log("RAZZER OS ready");
                
                // Auto-open MA/SPOT app after 1 second for demo
                setTimeout(() => {
                    razerOS.openApp('maspot');
                }, 1000);
                
            } catch (error) {
                console.error("Failed to initialize RAZZER OS:", error);
                alert("Error initializing RAZZER OS: " + error.message);
            }
        });
    </script>
</body>
</html>
